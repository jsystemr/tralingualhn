<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:fragment="head">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">  
<title th:replace="layout/layout :: titulo">Sistema </title>
  <link rel="stylesheet" th:href="@{/css/bootstrap.css}"/>
   <link rel="stylesheet" th:href="@{/css/bootstrap-glyphicons.css}"/>
  <link rel="stylesheet" th:href="@{/css/botonflotante.css}"/>
  <link rel="stylesheet" th:href="@{/css/font-awesome.min.css}">
  <link rel="stylesheet" th:href="@{/css/dropmenu.css}"/>
  <link rel="stylesheet" th:href="@{/css/stylepersonalize.css}"/>
  <script  th:src="@{/js/jquery-1.12.4.js}"></script> 
   <script th:src="@{/js/jquery.js}"></script>
  <script th:src="@{/js/bootstrap.js}"></script>
  <script type="text/javascript" th:src="@{/js/jquery-ui.js}"></script>
  <link rel="stylesheet" th:href="@{/css/jquery-ui-cupertino.css}">
 <!-- <link rel="stylesheet" th:href="@{/css/sidebar.css}"/>
      <script th:src="@{/js/funcionesJS.js}"></script> --> 
</head>
<body>

<nav  th:fragment="sidebarnavad" id="sidebar" class="sidebar-wrapper">
  	<div class="sidebar-content">
	 	<div class="sidebar-brand">
		        <a href="/producto/addpro">Siguasystem</a>
		        <div id="close-sidebar">
		          <i class=""><span aria-hidden="true" class="glyphicon glyphicon-remove"></span></i>
		        </div>
		   </div>
		<!--  Encabezado side-bar -->
		<div th:fragment="sidebar-header" class="sidebar-header">
			 <div class="user-pic">
		          <img class="img-responsive img-rounded" src="/imagenes/logogv.jfif"
		            alt="User picture">
		        </div>
		        <div class="user-info">
		          <span class="user-name">
		            <strong>Invitado</strong>
		          </span>
		          <span class="user-role">Invitado</span>
		          <span class="user-status">
		            <i class="fa fa-circle"></i>
		            <span>Online</span>
		          </span>
		        </div>
		</div>
		 <!-- Menu Administrativo solo puede verlo el Administrador -->
 	<div th:fragment="menuadmin" >
	<div sec:authorize="isAuthenticated()">
		<div th:fragment="nombreusuario">
			<div sec:authorize="isAuthenticated()">Authenticated as <span sec:authentication="name"></span>
				<form th:action="@{/logout}" method="post">
					<button class="btn btn-primary mb-2"><span class="glyphicon glyphicon-log-out"></span>Cerrar Session</button>
				</form>
			</div>
		</div>
		<!-- Nav tabs -->
				  <button class="navbar-toggler bg-light" type="button" data-toggle="collapse" data-target="#navbarText" aria-controls="navbarText" aria-expanded="false" aria-label="Toggle navigation">
				    <span class="navbar-toggler-icon"></span>
				  </button>
				<div class="collapse navbar-collapse " id="navbarText">
					<ul class="nav flex-column nav-pills container-fluid " id="myTab" role="tablist">
					  <li class="nav-item">
					    <a class="nav-link active" id="home-tab"   th:href="@{/producto/index}" role="tab" aria-controls="home" aria-selected="true">Inicio</a>
					  </li>
					  <li class="nav-item">
					    <a class="nav-link" id="profile-tab"  th:href="@{/empresa/index}" role="tab" aria-controls="profile" aria-selected="false">Empresas</a>
					  </li>
					    <li class="nav-item">
					    <a class="nav-link" id="messages-tab"  th:href="@{/productoadmin/index}" role="tab" aria-controls="messages" aria-selected="false">Catalogo de Productos</a>
					  </li>
					  <li class="nav-item">
					    <a class="nav-link" id="messages-tab"  th:href="@{/producto/index}" role="tab" aria-controls="messages" aria-selected="false">Productos a la Venta</a>
					  </li>
					</ul>
				</div>
			<!-- </div> -->
		<ul  class="list-group" >
			<li><h4 class="bg-white">Lista Acciones:</h4></li>
			
			<li class="nav-item">
			    <!-- Example single danger button -->
					<div class="card-header">
					   <button title="Generacion de Arqueos de Caja." type="button" class="btn btn-success  " data-toggle="collapse" href="#multiCollapsearq" aria-haspopup="true" aria-expanded="false">
					   Arqueo
					    </button>
					  <div class="collapse multi-collapse" id="multiCollapsearq">
					  <div class="dropdown-divider"></div>
						    <a class="card card-body" th:href="@{/arqueo/index}">Lista Arqueos</a>
						    <!-- th:href="@{/carritocompras/index}" -->
						     <div class="dropdown-divider"></div>
						     <a class="card card-body" th:href="@{/arqueo/crear}">Crear Arqueo</a>
						    <!-- th:href="@{/carritocompras/index}" -->
						     <div class="dropdown-divider"></div>
					    </div>
					  </div>
			  </li>
			
			<li class="nav-item">
			    <!-- Example single danger button -->
					<div class="card-header">
					   <button title="Reporte de Inventarios." type="button" class="btn btn-success  " data-toggle="collapse" href="#multiCollapseinv" aria-haspopup="true" aria-expanded="false">
					   Inventario
					    </button>
					  <div class="collapse multi-collapse" id="multiCollapseinv">
					  <div class="dropdown-divider"></div>
						    <a class="card card-body" th:href="@{/inventario/index}">Inventario Existencia</a>
						    <!-- th:href="@{/carritocompras/index}" -->
						     <div class="dropdown-divider"></div>
						     <a class="card card-body" th:href="@{/kardexep/vencen}">Inventario por Vencer</a>
						    <!-- th:href="@{/carritocompras/index}" -->
						     <div class="dropdown-divider"></div>
					    </div>
					  </div>
			  </li>
			
		 		
		     <li class="nav-item">
			    <!-- Example single danger button -->
					<div class="card-header">
					   <button title="Mantenimiento de Productos." type="button" class="btn btn-success  " data-toggle="collapse" href="#multiCollapsepro" aria-haspopup="true" aria-expanded="false">
					   Productos
					    </button>
					  <div class="collapse multi-collapse" id="multiCollapsepro">
						  <div class="dropdown-divider"></div>
						    <a  class="card card-body" th:href="@{/producto/addpro}">Crear Producto</a>
						    <div class="dropdown-divider"></div>
						    <a class="card card-body" th:href="@{/producto/index}">Listado de Productos</a>
						    <div class="dropdown-divider"></div>
							<a  class="card card-body" th:href="@{/producto/index}">Productos Activos</a>
							<div class="dropdown-divider"></div>
							<a  class="card card-body" th:href="@{/producto/proinactivos}">Productos Inactivos</a>
							<div class="dropdown-divider"></div>
					  </div>
					</div>
			  </li>
			<li class="nav-item">
		    <!-- Example single danger button -->
				<div class="card-header">
				   <button  type="button" class="btn btn-success" data-toggle="collapse" href="#multiCollapseExample2" aria-haspopup="true" aria-expanded="false">
				   Pedidos
				   </button>
				  <div class="collapse multi-collapse" id="multiCollapseExample2">
				  <div class="dropdown-divider"></div>
				    <a class="card card-body" th:href="@{/pedidos/index}">Crear Pedido</a><!-- th:href="@{/carritocompras/index}" -->
				     <div class="dropdown-divider"></div>
				    <a class="card card-body" th:href="@{/pedidos/listapedidosOpen}">Listado de Pedidos</a>
				    <div class="dropdown-divider"></div>
				    <a class="card card-body" href="#">Estadistica de Pedidos</a>
				    <div class="dropdown-divider"></div>
				    <a  class="card card-body" th:href="@{/pedidos/reportepedidos}">Imprimir Pedidos</a>
				    <div class="dropdown-divider"></div>
					<a  class="card card-body" th:href="@{/pedidos/todoslospedidos}">Todos los Pedidos</a>
 					<div class="dropdown-divider"></div>
					<a  class="card card-body" th:href="@{/pedidos/listapedidosOpen}">Lista de Pedidos Pendientes</a>
				  </div>
			</div>
		     </li>
		     <li class="nav-item">
			    <!-- Example single danger button -->
					<div class="card-header">
					   <button title="Mantenimiento de Proveedore." type="button" class="btn btn-success  " data-toggle="collapse" href="#multiCollapseprovee" aria-haspopup="true" aria-expanded="false">
					   Proveedor
					    </button>
					  <div class="collapse multi-collapse" id="multiCollapseprovee">
					  <div class="dropdown-divider"></div>
					    <a class="card card-body" th:href="@{/proveedor/crear}">Nuevo Proveedor</a><!-- th:href="@{/carritocompras/index}" -->
					     <div class="dropdown-divider"></div>
					    <a class="card card-body" th:href="@{/proveedor/index}">Listado de Proveedores</a>
					    <div class="dropdown-divider">
					    </div>
					  </div>
					</div>
			  </li>
		
			 <li class="nav-item">
			    <!-- Example single danger button -->
					<div class="card-header">
					   <button title="Entrada y Salida de Productos." type="button" class="btn btn-success  " data-toggle="collapse" href="#multiCollapseExample3" aria-haspopup="true" aria-expanded="false">
					   Kardex
					    </button>
					  <div class="collapse multi-collapse" id="multiCollapseExample3">
					  <div class="dropdown-divider"></div>
					    <a class="card card-body" th:href="@{/kardexep/index}">Nuevo Kardex</a><!-- th:href="@{/carritocompras/index}" -->
					     <div class="dropdown-divider"></div>
					    <a class="card card-body" th:href="@{/kardexep/listadokardexd}">Listado de Kardex</a>
					    <div class="dropdown-divider"></div>
					     <a class="card card-body" th:href="@{/kardexep/listadokardexfechap}">Listado de Kardex por Fechas</a>
					    <div class="dropdown-divider"></div>
					    <a class="card card-body" href="#">Estadistica de Kardex</a>
					    <div class="dropdown-divider"></div>
					  </div>
					</div>
			  </li>
			  <li class="nav-item">
			    <!-- Example single danger button -->
					<div class="card-header">
					   <button title="Entrada y Salida de Productos." type="button" class="btn btn-success  " data-toggle="collapse" href="#multiCollapseExample4" aria-haspopup="true" aria-expanded="false">
					   Kardex Historico
					    </button>
					  <div class="collapse multi-collapse" id="multiCollapseExample4">
					     <div class="dropdown-divider"></div>
					    <a class="card card-body" th:href="@{/kardexe/listadokardexkh}">Listado de Kardex Historico</a>
					    <div class="dropdown-divider"></div>
					    <a class="card card-body" href="#">Estadistica de Kardex Historico</a>
					    <div class="dropdown-divider"></div>
					  </div>
					</div>
			  </li>
			  <li class="nav-item">
			    <!-- Example single danger button -->
					<div class="card-header">
					   <button title="Mantenimiento de Empresas." type="button" class="btn btn-success  " data-toggle="collapse" href="#multiCollapstpk" aria-haspopup="true" aria-expanded="false">
					   Tipo Kardex
					    </button>
					  <div class="collapse multi-collapse" id="multiCollapstpk">
					  <div class="dropdown-divider"></div>
					    <a class="card card-body" th:href="@{/tipokardex/crear}">Nuevo Tipokardex</a><!-- th:href="@{/carritocompras/index}" -->
					     <div class="dropdown-divider"></div>
					    <a class="card card-body" th:href="@{/tipokardex/index}">Listado de Tipokardex</a>
					    <div class="dropdown-divider">
					    </div>
					  </div>
					</div>
			  </li>
			<li class="nav-item">
			    <!-- Example single danger button -->
					<div class="card-header">
					   <button title="Mantenimiento de Empresas." type="button" class="btn btn-success  " data-toggle="collapse" href="#multiCollapsempre" aria-haspopup="true" aria-expanded="false">
					   Empresas
					    </button>
					  <div class="collapse multi-collapse" id="multiCollapsempre">
					  <div class="dropdown-divider"></div>
					    <a class="card card-body" th:href="@{/empresa/formemp}">Nuevo Empresa</a><!-- th:href="@{/carritocompras/index}" -->
					     <div class="dropdown-divider"></div>
					    <a class="card card-body" th:href="@{/empresa/index}">Listado de Empresas</a>
					    <div class="dropdown-divider">
					    </div>
					  </div>
					</div>
			  </li>
			<!-- <li class="list-group-item list-group-item-action btn-primary "><a th:href="@{/gdestroy}">Limpiar Pedidos sin Procesar</a></li> -->
		</ul>
	</div>
</div>
		
		<div>
			<ul  class="">		
				<li >..<span class="glyphicon glyphicon-tags"></span></li>
				<li >..<span class="glyphicon glyphicon-tags"></span></li>
			</ul>
		</div>
	<!-- sidebar-content  -->
	</div>
			
    <div th:fragment="pie-sidebar" class="sidebar-footer">
	     <h4 class="bg-white">
			Pedido Total L.<span class="badge badge-secondary"  th:text="${total>0?total:'0.00'}"></span>
			<!-- <span 	class="glyphicon glyphicon-shopping-cart"></span> -->
			<button class="btn btn-success" id="proscompra">
				<span class="glyphicon glyphicon-shopping-cart"></span>Procesar
			Compra
		</button>
			
		<button class="btn btn-primary mb-2 mt-2" id="verpedido"
			data-toggle="modal">
			<span class=" glyphicon glyphicon-th-list"></span> Ver Pedido
		</button>#<span class="badge badge-secondary" th:text="${n>0?n:'0'}" id="nproductos">
			</span>
		<form  th:action="@{destroy}" method="post">
			<button type="submit" class="btn btn-primary mb-2">
				<span class=" 	glyphicon  glyphicon-trash"></span> Limpiar
				Pedido
			</button>
		</form>
		</h4>
     </div>
	
		<script type="text/javascript">
	$(function() {
		
		//funcion para mostrar menu con imagenes
		$('#menuimg').on('click',function(){
			var url = "[[@{productosmodel}]]";
			console.log(url);
			window.location.href = url;
		});
		
		$('#menunoimg').on('click',function(){
			var url = "[[@{listaproductos}]]";
			console.log(url);
			window.location.href = url;
		});
		/*********************************************/
		  $(".sidebar-dropdown > a").click(function() {
			  $(".sidebar-submenu").slideUp(200);
			  if (
			    $(this)
			      .parent()
			      .hasClass("active")
			  ) {
			    $(".sidebar-dropdown").removeClass("active");
			    $(this)
			      .parent()
			      .removeClass("active");
			  } else {
			    $(".sidebar-dropdown").removeClass("active");
			    $(this)
			      .next(".sidebar-submenu")
			      .slideDown(200);
			    $(this)
			      .parent()
			      .addClass("active");
			  }
		});
		//oculta el SideBar por Defecto
		$(".page-wrapper").removeClass("toggled");
		$("#close-sidebar").click(function() {
		  $(".page-wrapper").removeClass("toggled");
		});
		$("#show-sidebar").click(function() {
		  $(".page-wrapper").addClass("toggled");
		});
		/*********************************************/
	});
	</script>
 </nav>	

<footer  th:fragment="footer" class="container">

</footer>
<!-- Modal Pedidos -->
<div th:fragment="modalpedido" class="modal" tabindex="-1" role="dialog" data-target=".pdido" id="pdido">
				<div class="modal-dialog modal-dialog-scrollable" role="document">
					<div class="modal-content">
						<div class="modal-header">
							<h4 >
							Su Pedido: Total L.<span class="badge badge-secondary"
							th:text="${total>0?total:'0.00'}"></span></h4>
							<button type="button" class="close" data-dismiss="modal"
								aria-label="Close">
								<span aria-hidden="true" class="glyphicon glyphicon-remove"></span>
							</button>
						</div>
						<div class="modal-body">
							<ul th:each="m,mStat: ${pedido}" class="list-group" id="list-tab"
								role="tablist" data-toggle="list">
								<li class="list-group-item list-group-item-action mt-2">
								<span class="badge badge-secondary"
							th:text="${mStat.index+1}"></span>
									<button type="button" class="close" data-dismiss="alert"
										aria-label="Close" th:id="${mStat.index}"
										th:onclick="|javascript:delProducto('${mStat.index}')|">
										<span aria-hidden="true"
											class="glyphicon glyphicon-remove-circle "></span>
									</button>
									<img class="card-img-top img-thumbnail rounded mx-auto d-block img-fluid"
									th:src="${(utilidad.getImagenString(m)!=null)?'/uploads/'+utilidad.getImagenString(m):'/imagenes/indice.svg'}"
									alt="Card image cap" style="max-width:180px; height:150px;">
                                     <!-- th:src="${!(#strings.isEmpty(imgpedido))?'data:image/png;base64,'+imgpedido[mStat.index]:'/imagenes/indice.svg'}" --> 
									<p th:text="${m}">Producto..</p>
								</li>
							</ul>
						</div>
						<div class="modal-footer">
							<!--  <button type="button" class="btn btn-primary">Save changes</button> -->
							<button type="button" class="btn btn-secondary"
								data-dismiss="modal">Close</button>
						</div>
					</div>
				</div>
</div>
<!-- Modal Pago -->
<div th:fragment="modalpago" class="modal" tabindex="-1" role="dialog" data-target=".pcompra"
				id="pcompra">
				<div class="modal-dialog modal-dialog-scrollable" role="document">
					<div class="modal-content">
						<div class="modal-header">
							<h5 class="modal-title">Ingrese los datos para procesar su
								pedido. <br/>Total L. <span class="badge badge-secondary"
							th:text="${total>0?total:'0.00'}"></span></h5>
							<button type="button" class="close" data-dismiss="modal"
								aria-label="Close">
								<span aria-hidden="true" class="glyphicon glyphicon-remove"></span>
							</button>
						</div>
						<div class="modal-body">
							<form class="frmcompra" th:action="@{/pedidos/guardarPedidolista}"
								method="post">
								<!-- <textarea name="msg" class="control-group" style="width: 100%;"></textarea> -->
								<input type="hidden" name="total" class="form-control"
									id="total" th:value="${total>0?total:'0.00'}">
								 <h4>Tipo de Orden:
									 	<select id="tipoorden"  name="tipoorden" class="form-control" required >
									 	<!--  <option value="-1" >---Seleccione un tipo de orden-- </option> -->
										    <option th:each="e : ${ltpo}" th:value="${e.id+':'+e.tipo}" th:text="${e.tipo}">
										    </option>
										</select>
									</h4>
								<h4 class="bg-white">(*) Ingrese su Correo:</h4>
								<input type="email" name="correo" class="form-control"
									id="correo" placeholder="name@example.com" required>
								<h4 class="bg-white">(*) Ingrese su numero de Telefono:</h4>
								<input type="tel" class="form-control" name="telefono"
									id="telefono" placeholder="9570-6655" required> 
									<h4 class="bg-white">(*) Ingrese su Nombre(opcional):</h4>
								<input type="text" class="form-control" name="nombre"
									id="nombre" placeholder="Juan Carlos Doe" > 
								<input type="hidden" class="form-control" name="rtn"
									id="rtn" placeholder="0318199802051" > 
							   <h4 class="bg-white">(*) Direccion de Envio:</h4>
							   <textarea rows="3" cols="65" name="direccion" required></textarea>
								<input name="latitud" class="form-control" id="lati" type="hidden" >
								<input name="longitud"class="form-control" id="longi" type="hidden" >	
												<button class="btn btn-primary ">
								<span class="glyphicon glyphicon-send"></span> Enviar Pedido
								</button>
								<button type="button" class="btn btn-secondary"
								data-dismiss="modal">Agregar mas productos</button>
								<hr>
							</form>
						</div>
						<div class="modal-footer">
							<!--  <button type="button" class="btn btn-primary">Save changes</button> -->

						</div>
					</div>
				</div>
			</div>
</body>
</html>